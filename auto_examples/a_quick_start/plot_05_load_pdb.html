<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Load a PDB structure file &#8212; cocoatree 0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=d7e2fa82" />
    <link rel="stylesheet" type="text/css" href="../../_static/nameko.css?v=2296cfae" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <script src="../../_static/documentation_options.js?v=837179f8"></script>
    <script src="../../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Lora:400' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

  </head><body><div class="navbar related">
      <a href="../../index.html">
        
      </a>
    <ul class="nav nav-pills nav-stacked">
      <li class="right"><a href="../index.html">Gallery</a> </li>
      <li class="right"><a href="../../modules/classes.html">API</a> | </li>
      <li class="right"><a href="../../install.html">Installation</a> | </li>
      <li class="right"><a href="../../index.html">Home</a> | </li>
      
    </ul>
  </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-examples-a-quick-start-plot-05-load-pdb-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code or to run this example in your browser via Binder.</p>
</div>
<section class="sphx-glr-example-title" id="load-a-pdb-structure-file">
<span id="sphx-glr-auto-examples-a-quick-start-plot-05-load-pdb-py"></span><h1>Load a PDB structure file<a class="headerlink" href="#load-a-pdb-structure-file" title="Link to this heading">¶</a></h1>
<p>This small example shows how to use <a class="reference internal" href="../../modules/generated/cocoatree.io.load_pdb.html#cocoatree.io.load_pdb" title="cocoatree.io.load_pdb"><code class="xref py py-func docutils literal notranslate"><span class="pre">cocoatree.io.load_pdb()</span></code></a> to import
your own PDB structure file.</p>
<p>This function allows you to extract the amino acid sequence associated with the
PDB file, as well as the residue numbering, which is necessary to specify the
residues to highlight in PyMOL for example.</p>
<p>Import necessary packages</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">cocoatree.io</span><span class="w"> </span><span class="kn">import</span> <a href="../../modules/generated/cocoatree.io.load_pdb.html#cocoatree.io.load_pdb" title="cocoatree.io.load_pdb" class="sphx-glr-backref-module-cocoatree-io sphx-glr-backref-type-py-function"><span class="n">load_pdb</span></a>

<span class="c1"># Provide path for thumbnail image</span>
<span class="c1"># sphinx_gallery_thumbnail_path = &#39;../../doc/images/3TGI.png&#39;</span>
</pre></div>
</div>
<p>We will use the PDB structure of rat trypsin as an example. The file can be
downloaded at: <a class="reference external" href="https://www.rcsb.org/structure/3TGI">https://www.rcsb.org/structure/3TGI</a>. It is also the structure
that is included in <a class="reference internal" href="../../modules/generated/cocoatree.datasets.load_S1A_serine_proteases.html#cocoatree.datasets.load_S1A_serine_proteases" title="cocoatree.datasets.load_S1A_serine_proteases"><code class="xref py py-func docutils literal notranslate"><span class="pre">cocoatree.datasets.load_S1A_serine_proteases()</span></code></a>.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">pdb_seq</span></a><span class="p">,</span> <a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">pdb_pos</span></a> <span class="o">=</span> <a href="../../modules/generated/cocoatree.io.load_pdb.html#cocoatree.io.load_pdb" title="cocoatree.io.load_pdb" class="sphx-glr-backref-module-cocoatree-io sphx-glr-backref-type-py-function"><span class="n">load_pdb</span></a><span class="p">(</span><span class="s1">&#39;data/3TGI.pdb&#39;</span><span class="p">,</span> <span class="n">pdb_id</span><span class="o">=</span><span class="s1">&#39;3TGI&#39;</span><span class="p">,</span> <span class="n">chain</span><span class="o">=</span><span class="s1">&#39;E&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">pdb_id</span></code> argument is the ID that will be used for the structure, in
this case, we choose <cite>3TGI</cite>, but it could be <cite>TRYPSIN</cite> or any name that the
user finds fitting.</p>
<p>In order to understand the function’s <code class="docutils literal notranslate"><span class="pre">chain</span></code> argument, you need to open
the PDB in an editor to check the information included within your file:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;HEADER    COMPLEX (SERINE PROTEASE/INHIBITOR)     15-JUL-98   3TGI</span>
<span class="sd">TITLE     WILD-TYPE RAT ANIONIC TRYPSIN COMPLEXED WITH BOVINE</span>
<span class="sd">TITLE    2 PANCREATIC TRYPSIN INHIBITOR (BPTI)</span>
<span class="sd">COMPND    MOL_ID: 1;</span>
<span class="sd">COMPND   2 MOLECULE: TRYPSIN;</span>
<span class="sd">COMPND   3 CHAIN: E;</span>
<span class="sd">COMPND   4 EC: 3.4.21.4;</span>
<span class="sd">COMPND   5 MOL_ID: 2;</span>
<span class="sd">COMPND   6 MOLECULE: BOVINE PANCREATIC TRYPSIN INHIBITOR;</span>
<span class="sd">COMPND   7 CHAIN: I;</span>
<span class="sd">COMPND   8 SYNONYM: BPTI</span>
<span class="sd">SOURCE    MOL_ID: 1;</span>
<span class="sd">SOURCE   2 ORGANISM_SCIENTIFIC: RATTUS NORVEGICUS;</span>
<span class="sd">SOURCE   3 ORGANISM_COMMON: NORWAY RAT;</span>
<span class="sd">SOURCE   4 ORGANISM_TAXID: 10116;</span>
<span class="sd">SOURCE   5 ORGAN: PANCREATIC;</span>
<span class="sd">SOURCE   6 MOL_ID: 2;</span>
<span class="sd">SOURCE   7 ORGANISM_SCIENTIFIC: BOS TAURUS;</span>
<span class="sd">SOURCE   8 ORGANISM_COMMON: CATTLE;</span>
<span class="sd">SOURCE   9 ORGANISM_TAXID: 9913&quot;&quot;&quot;</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&#39;HEADER    COMPLEX (SERINE PROTEASE/INHIBITOR)     15-JUL-98   3TGI\nTITLE     WILD-TYPE RAT ANIONIC TRYPSIN COMPLEXED WITH BOVINE\nTITLE    2 PANCREATIC TRYPSIN INHIBITOR (BPTI)\nCOMPND    MOL_ID: 1;\nCOMPND   2 MOLECULE: TRYPSIN;\nCOMPND   3 CHAIN: E;\nCOMPND   4 EC: 3.4.21.4;\nCOMPND   5 MOL_ID: 2;\nCOMPND   6 MOLECULE: BOVINE PANCREATIC TRYPSIN INHIBITOR;\nCOMPND   7 CHAIN: I;\nCOMPND   8 SYNONYM: BPTI\nSOURCE    MOL_ID: 1;\nSOURCE   2 ORGANISM_SCIENTIFIC: RATTUS NORVEGICUS;\nSOURCE   3 ORGANISM_COMMON: NORWAY RAT;\nSOURCE   4 ORGANISM_TAXID: 10116;\nSOURCE   5 ORGAN: PANCREATIC;\nSOURCE   6 MOL_ID: 2;\nSOURCE   7 ORGANISM_SCIENTIFIC: BOS TAURUS;\nSOURCE   8 ORGANISM_COMMON: CATTLE;\nSOURCE   9 ORGANISM_TAXID: 9913&#39;
</pre></div>
</div>
<dl class="simple">
<dt>As you can see, there are actually two molecules in the PDB:</dt><dd><ul class="simple">
<li><p>rat trypsin</p></li>
<li><p>bovine pancreatic trypsin inhibitor</p></li>
</ul>
</dd>
</dl>
<p>It is necessary to specify which molecule you wish to load by using the
<code class="docutils literal notranslate"><span class="pre">chain</span></code> argument. In this case, it is <code class="docutils literal notranslate"><span class="pre">chain='E'</span></code> for trypsin, and
<code class="docutils literal notranslate"><span class="pre">chain='I'</span></code> for the trypsin inhibitor.</p>
<p>For a comparison, here are the first lines of E. coli dihydrofolate
reductase’s PDB file (which is the one included in cocoatree’s
<a class="reference internal" href="../../modules/generated/cocoatree.datasets.load_DHFR.html#cocoatree.datasets.load_DHFR" title="cocoatree.datasets.load_DHFR"><code class="xref py py-func docutils literal notranslate"><span class="pre">cocoatree.datasets.load_DHFR()</span></code></a>):</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot;HEADER    OXIDOREDUCTASE                          02-FEB-11   3QL0</span>
<span class="sd">TITLE     CRYSTAL STRUCTURE OF N23PP/S148A MUTANT OF E. COLI DIHYDROFOLATE</span>
<span class="sd">TITLE    2 REDUCTASE</span>
<span class="sd">COMPND    MOL_ID: 1;</span>
<span class="sd">COMPND   2 MOLECULE: DIHYDROFOLATE REDUCTASE;</span>
<span class="sd">COMPND   3 CHAIN: A;</span>
<span class="sd">COMPND   4 EC: 1.5.1.3;</span>
<span class="sd">COMPND   5 ENGINEERED: YES;</span>
<span class="sd">COMPND   6 MUTATION: YES</span>
<span class="sd">SOURCE    MOL_ID: 1;</span>
<span class="sd">SOURCE   2 ORGANISM_SCIENTIFIC: ESCHERICHIA COLI;</span>
<span class="sd">SOURCE   3 ORGANISM_TAXID: 364106;</span>
<span class="sd">SOURCE   4 STRAIN: UTI89 / UPEC;</span>
<span class="sd">SOURCE   5 GENE: FOLA, UTI89_C0054;</span>
<span class="sd">SOURCE   6 EXPRESSION_SYSTEM: ESCHERICHIA COLI;</span>
<span class="sd">SOURCE   7 EXPRESSION_SYSTEM_TAXID: 562&quot;&quot;&quot;</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&#39;HEADER    OXIDOREDUCTASE                          02-FEB-11   3QL0\nTITLE     CRYSTAL STRUCTURE OF N23PP/S148A MUTANT OF E. COLI DIHYDROFOLATE\nTITLE    2 REDUCTASE\nCOMPND    MOL_ID: 1;\nCOMPND   2 MOLECULE: DIHYDROFOLATE REDUCTASE;\nCOMPND   3 CHAIN: A;\nCOMPND   4 EC: 1.5.1.3;\nCOMPND   5 ENGINEERED: YES;\nCOMPND   6 MUTATION: YES\nSOURCE    MOL_ID: 1;\nSOURCE   2 ORGANISM_SCIENTIFIC: ESCHERICHIA COLI;\nSOURCE   3 ORGANISM_TAXID: 364106;\nSOURCE   4 STRAIN: UTI89 / UPEC;\nSOURCE   5 GENE: FOLA, UTI89_C0054;\nSOURCE   6 EXPRESSION_SYSTEM: ESCHERICHIA COLI;\nSOURCE   7 EXPRESSION_SYSTEM_TAXID: 562&#39;
</pre></div>
</div>
<p>In this case, there is only one molecule, which is accessed by specifying
<code class="docutils literal notranslate"><span class="pre">chain='A'</span></code>.</p>
<p>You can now access the pdb sequence and the residue numbering:</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#str" title="builtins.str" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">pdb_seq</span></a><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#list" title="builtins.list" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">pdb_pos</span></a><span class="p">)</span>

<span class="c1"># ..seealso::</span>
<span class="c1">#       :ref:`sphx_glr_auto_examples_a_quick_start_03_plot_map_alignments.py`</span>
<span class="c1">#       to see how to perform a mapping of the positions between your MSA and</span>
<span class="c1">#       the PDB structure.</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>IVGGYTCQENSVPYQVSLNSGYHFCGGSLINDQWVVSAAHCYKSRIQVRLGEHNINVLEGNEQFVNAAKIIKHPNFDRKTLNNDIMLIKLSSPVKLNARVATVALPSSCAPAGTQCLISGWGNTLSSGVNEPDLLQCLDAPLLPQADCEASYPGKITDNMVCVGFLEGGKDSCQGDSGGPVVCNGELQGIVSWGYGCALPDNPGVYTKVCNYVDWIQDTIAAN
[&#39;16&#39;, &#39;17&#39;, &#39;18&#39;, &#39;19&#39;, &#39;20&#39;, &#39;21&#39;, &#39;22&#39;, &#39;23&#39;, &#39;24&#39;, &#39;25&#39;, &#39;26&#39;, &#39;27&#39;, &#39;28&#39;, &#39;29&#39;, &#39;30&#39;, &#39;31&#39;, &#39;32&#39;, &#39;33&#39;, &#39;34&#39;, &#39;37&#39;, &#39;38&#39;, &#39;39&#39;, &#39;40&#39;, &#39;41&#39;, &#39;42&#39;, &#39;43&#39;, &#39;44&#39;, &#39;45&#39;, &#39;46&#39;, &#39;47&#39;, &#39;48&#39;, &#39;49&#39;, &#39;50&#39;, &#39;51&#39;, &#39;52&#39;, &#39;53&#39;, &#39;54&#39;, &#39;55&#39;, &#39;56&#39;, &#39;57&#39;, &#39;58&#39;, &#39;59&#39;, &#39;60&#39;, &#39;61&#39;, &#39;62&#39;, &#39;63&#39;, &#39;64&#39;, &#39;66&#39;, &#39;67&#39;, &#39;68&#39;, &#39;69&#39;, &#39;70&#39;, &#39;71&#39;, &#39;72&#39;, &#39;73&#39;, &#39;74&#39;, &#39;75&#39;, &#39;76&#39;, &#39;77&#39;, &#39;78&#39;, &#39;79&#39;, &#39;80&#39;, &#39;81&#39;, &#39;82&#39;, &#39;83&#39;, &#39;84&#39;, &#39;85&#39;, &#39;86&#39;, &#39;87&#39;, &#39;88&#39;, &#39;89&#39;, &#39;90&#39;, &#39;91&#39;, &#39;92&#39;, &#39;93&#39;, &#39;94&#39;, &#39;95&#39;, &#39;96&#39;, &#39;97&#39;, &#39;98&#39;, &#39;99&#39;, &#39;100&#39;, &#39;101&#39;, &#39;102&#39;, &#39;103&#39;, &#39;104&#39;, &#39;105&#39;, &#39;106&#39;, &#39;107&#39;, &#39;108&#39;, &#39;109&#39;, &#39;110&#39;, &#39;111&#39;, &#39;112&#39;, &#39;113&#39;, &#39;114&#39;, &#39;115&#39;, &#39;116&#39;, &#39;117&#39;, &#39;118&#39;, &#39;119&#39;, &#39;120&#39;, &#39;121&#39;, &#39;122&#39;, &#39;123&#39;, &#39;124&#39;, &#39;125&#39;, &#39;127&#39;, &#39;128&#39;, &#39;129&#39;, &#39;130&#39;, &#39;132&#39;, &#39;133&#39;, &#39;134&#39;, &#39;135&#39;, &#39;136&#39;, &#39;137&#39;, &#39;138&#39;, &#39;139&#39;, &#39;140&#39;, &#39;141&#39;, &#39;142&#39;, &#39;143&#39;, &#39;144&#39;, &#39;145&#39;, &#39;146&#39;, &#39;147&#39;, &#39;148&#39;, &#39;149&#39;, &#39;150&#39;, &#39;151&#39;, &#39;152&#39;, &#39;153&#39;, &#39;154&#39;, &#39;155&#39;, &#39;156&#39;, &#39;157&#39;, &#39;158&#39;, &#39;159&#39;, &#39;160&#39;, &#39;161&#39;, &#39;162&#39;, &#39;163&#39;, &#39;164&#39;, &#39;165&#39;, &#39;166&#39;, &#39;167&#39;, &#39;168&#39;, &#39;169&#39;, &#39;170&#39;, &#39;171&#39;, &#39;172&#39;, &#39;173&#39;, &#39;174&#39;, &#39;175&#39;, &#39;176&#39;, &#39;177&#39;, &#39;178&#39;, &#39;179&#39;, &#39;180&#39;, &#39;181&#39;, &#39;182&#39;, &#39;183&#39;, &#39;184&#39;, &#39;184A&#39;, &#39;185&#39;, &#39;186&#39;, &#39;187&#39;, &#39;188&#39;, &#39;188A&#39;, &#39;189&#39;, &#39;190&#39;, &#39;191&#39;, &#39;192&#39;, &#39;193&#39;, &#39;194&#39;, &#39;195&#39;, &#39;196&#39;, &#39;197&#39;, &#39;198&#39;, &#39;199&#39;, &#39;200&#39;, &#39;201&#39;, &#39;202&#39;, &#39;203&#39;, &#39;204&#39;, &#39;209&#39;, &#39;210&#39;, &#39;211&#39;, &#39;212&#39;, &#39;213&#39;, &#39;214&#39;, &#39;215&#39;, &#39;216&#39;, &#39;217&#39;, &#39;219&#39;, &#39;220&#39;, &#39;221&#39;, &#39;221A&#39;, &#39;222&#39;, &#39;223&#39;, &#39;224&#39;, &#39;225&#39;, &#39;226&#39;, &#39;227&#39;, &#39;228&#39;, &#39;229&#39;, &#39;230&#39;, &#39;231&#39;, &#39;232&#39;, &#39;233&#39;, &#39;234&#39;, &#39;235&#39;, &#39;236&#39;, &#39;237&#39;, &#39;238&#39;, &#39;239&#39;, &#39;240&#39;, &#39;241&#39;, &#39;242&#39;, &#39;243&#39;, &#39;244&#39;, &#39;245&#39;]
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> (0 minutes 0.021 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-a-quick-start-plot-05-load-pdb-py">
<div class="binder-badge docutils container">
<a class="reference external image-reference" href="https://mybinder.org/v2/gh/tree-timc/cocoatree/gh-pages?urlpath=lab/tree/notebooks/auto_examples/a_quick_start/plot_05_load_pdb.ipynb"><img alt="Launch binder" src="../../_images/binder_badge_logo.svg" style="width: 150px;" />
</a>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/22c5a07eacc567ab56d45762bc10d49e/plot_05_load_pdb.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_05_load_pdb.ipynb</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/c1c47cf44f563b9a8a9a0266bdaa9175/plot_05_load_pdb.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_05_load_pdb.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-zip docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/aa47540c461b92ae33a5010981a67a29/plot_05_load_pdb.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">zipped:</span> <span class="pre">plot_05_load_pdb.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  </body>
</html>