
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/plot_sector_along_tree_and_metadata.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_plot_sector_along_tree_and_metadata.py>`
        to download the full example code. or to run this example in your browser via Binder

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_plot_sector_along_tree_and_metadata.py:


==========================================================
Plot sector together with (phylogenetic) tree and metadata
==========================================================

A small example that shows how to plot the sector composition
within a tree and to add metadata

.. GENERATED FROM PYTHON SOURCE LINES 10-32







.. code-block:: Python


    import pandas as pd
    from cocoatree.io import load_MSA, load_tree_ete3
    from cocoatree.visualization import update_tree_ete3_and_return_style

    annot_file = 'data/random_seq_tree_annotations.csv'
    df_annot = pd.read_csv(annot_file)

    tree_file = 'data/random_seq_tree_kpicsg_ete3.treefile'
    tree_ete3 = load_tree_ete3(tree_file)

    sector_file = 'data/SCA_sector_1_core_tagged_seq.fasta'
    sector_id, sector_seq = load_MSA(sector_file, 'fasta')

    tree_style = update_tree_ete3_and_return_style(
        tree_ete3, df_annot, sector_id, sector_seq,
        meta_data=('class', 'HMM_annotation', 'superkingdom'),
        fig_title='Test HMM annot',
        t_sector_seq=False,
        t_sector_heatmap=True,
        colormap='inferno'
        )


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 0.933 seconds)


.. _sphx_glr_download_auto_examples_plot_sector_along_tree_and_metadata.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: binder-badge

      .. image:: images/binder_badge_logo.svg
        :target: https://mybinder.org/v2/gh/tree-timc/cocoatree/gh-pages?urlpath=lab/tree/notebooks/auto_examples/plot_sector_along_tree_and_metadata.ipynb
        :alt: Launch binder
        :width: 150 px

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_sector_along_tree_and_metadata.ipynb <plot_sector_along_tree_and_metadata.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_sector_along_tree_and_metadata.py <plot_sector_along_tree_and_metadata.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_sector_along_tree_and_metadata.zip <plot_sector_along_tree_and_metadata.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
